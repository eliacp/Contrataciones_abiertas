var json =
{
    "name": "Contratos abiertos",
    "text":"",
    "children": [
        {
            "name": "Planeación",
            "text":"",
            "children": [
                {
                    "name": "Presupuesto",
                    "text":"",
                    "children": [
                        {"name": "Fuente","text":"Presupuesto de Egresos de la Fedración 2015 y 2016"},
                        {"name": "ID","text":"1409JZL0005"},
                        {"name": "Descripción","text":"Transferencias a fideicomisos públicos"},
                        {"name": "Total","text":"$490,000,000.00"},
                        {"name": "Proyecto presupuestario","text":"Nuevo Aeropuerto Internacional de la Ciudad de México"}
                    ]
                },
                {"name":"Fundamento",
                    "text":'Dado que las precipitaciones locales escurrierón hacia las zonas más bajas del polígono, lo que antiguamente fuera el lago de Texcoco, durante la construcción del NAICM se requeririó; un drenaje pluvial provisional de funcionamiento temporal dentro del perímetro de la construcción, que permita asegurar la protección de dichas obras. Lo anterior, con el objetivo de asegurar que las zonas donde se esté desarrollando los trabajos permanezcan secas.'},
                {
                    "name": "Documentos",
                    "text":"",
                    "children": [
                        {"name": "Estudio factibilidad", "text":"Factibilidad técnica, legal y ambiental del proyecto de desarrollo del Nuevo Aeropuerto Internacional de la Ciudad de México"},
                        {"name": "Evaluación necesidades", "text":"Términos de referencia para la construcción del drenaje pluvial temporal para la protección de la zona durante la construcción de la primera fase del NAICM publicados en CompraNet el 24 de junio de 2015"},
                        {"name": "Estudio mercado", "text":"No aplica"}
                    ]
                }
            ]
        },
        {
            "name": "Licitación",
            "text":"",
            "children": [
                {"name": "ID","text":"838749"},
                {"name": "Titulo","text":"Para los trabajos relativos a la construcción del drenaje pluvial temporal"},
                {"name": "Descripción","text":"Licitación Pública Nacional que tuvo por objeto la adjudicación del contrato para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México."},
                {"name": "Estatus","text":"Adjudicado"},
                {"name": "Valor mínimo","text":"No aplica"},
                {"name": "Valor","text":"490,000,000.00"},
                {"name": "Método de adquisición","text":"Licitación Pública",
                    "children":[
                        {"name": "Carácter","text":"Nacional"},
                        {"name": "Forma del proceso","text":"Presencial"},
                        {"name":"Fundamento","text":"Artículo 27, segundo párrafo de la Ley de Obras Públicas y Servicios Relacionados con las Mismas"}
                    ]},
                {"name": "Item","text":"",
                    "children":[
                        {"name":"Clasificación","text":"62501001"},
                        {"name":"Cantidad","text":"1"},
                        {"name":"Unidad","text":"Obra"}
                    ]},
                {"name": "Criterio Adjudicación","text":"Puntos y Porcentajes",
                    "children":[{"name":"Detalles","text":"1. EVALUACIÓN DE LA PROPUESTA TÉCNICA: I. CALIDAD DE LA OBRA.- (a) Que los materiales propuestos para la ejecución de los trabajos cumplan con los estándares de calidad y medidas ambientales. (3.0); (b) Mano de Obra. Que la mano de obra propuesta para la ejecución de los trabajos, cumpla con los requisitos administrativos y con las aptitudes establecidos (3.0); (c) Maquinaria y equipo. Que la maquinaria y vehículos propuestos para la ejecución de los trabajos cumplan con los estándares de calidad y medidas ambientales exigidas (5.0); (d) Esquema estructural de la organización de los profesionales técnicos que se encargarán de la dirección y coordinación de los trabajos. Que el esquema estructural de profesionales técnicos (organigrama) propuesto, es el adecuado, suficiente y necesario (0.5); (e) Procedimiento constructivo. Que las técnicas propuestas a utilizar para la ejecución de los trabajos, sean congruentes con las características, complejidad y magnitud de trabajos a ejecutar en el proyecto (5.0); (f) Programas. Que exista una congruencia entre los programas generales y específicos de la obra (1.5), y (g) Descripción de la planeación integral para la ejecución de los trabajos. Explicación detallada de los procesos que se utilizaran en la ejecución, desarrollo y organización de los trabajos (2.0). II. CAPACIDAD LICITANTE.- (a) Capacidad de los recursos humanos. Que el personal profesional técnico ha participado en por lo menos 5 proyectos similares al que se licita (5.0); (b) Capacidad de los recursos económicos. Serán los recursos económicos que se consideren necesarios para que el licitante cumpla con el contrato (4.0); (c) Participación de discapacitados o empresas que cuenten con trabajadores con discapacidad (0.5), y (d) Subcontratación de MIPYMES. Se otorgará al licitante el puntaje indicado; se verificará que la proposición que contenga la documentación con la cual demuestre que subcontratará MIPYMES (0.5). III. EXPERIENCIA Y ESPECIALIDAD.- (a) Experiencia. Se verificará que el licitante durante los últimos 10 años ha ejecutado obras similares a los que se licitan (7.0), y (b) Especialidad. Se verificará que dentro de los últimos 10 años, el licitante ha ejecutado por lo menos 5 obras con las características, complejidad y magnitud específicas y a los volúmenes y condiciones similares a las requeridas por la convocante (8.0). IV. CUMPLIMIENTO DE CONTRATOS.- (a) Cumplimiento de contratos. Se verificará que por lo menos 5 obras ejecutadas por el licitante en los últimos 10 años, se hayan terminado en tiempo y forma (5.0).   2. EVALUACIÓN DE LA PROPUESTA EÉ El total de pÉde la proposición económica, tendrá un valor numérico máximo de 50. Para llevar a cabo la evaluación de la propuesta económica, la convocante verificará que el análisis, cálculo e integración de los precios cumplan con la condición de pago establecida en la convocatoria o Licitación en términos del artículo 45 de la Ley y los artículos 45 y del 185 al 220"}]},
                {"name": "Método de recepción","text":"Presencial",
                    "children":[{"name":"Detalles","text":"El acto de presentación y apertura de proposiciones se llevó a cabo a las 12:00 horas del 6 de agosto de 2015, en la sala de juntas ubicada en Av. Insurgentes Sur 2453, piso 2, Torre Murano, Colonia Tizapan San Angel, Delegación Alvaro Obregón, México, D.F., C.P. 01090. El acto fue presidido por el Subdirector de Contrataciones de GACM.    Los documentos técnicos T.2 y T.3, así como la documentación económica E-10, correspondiente a las 32 proposiciones presentadas, fueron rubricados por los representantes de tres licitantes y un consorcio."}]
                },
                {"name": "Periodo recepción de propuestas","text":"08/06/2015"},
                {"name": "Periodo aclaraciones","text":"",
                    "children":[{"name":"inicio","text":"07/03/2015"},
                        {"name":"fin","text":"07/22/2015"}]},
                {"name": "Criterio de elegibilidad","text":"Numeral 2.10 de la Convocatoria"},
                {"name": "Periodo adjudicación","text":"07/21/2015"},
                {"name": "Tuvo aclaraciones","text":"371"},
                {"name": "Tuvo testigo social","text":"1"},
                {"name": "Testigo social","text":"",
                    "children":[{"name":"ID","text":"IMA941216HE8"},
                        {"name":"Nombre","text":"Instituto Mexicano de Auditoría Técnica, A. C."}]},
                {"name": "Número de participantes","text":"32"},
                {"name": "Entidad que contrata", "text":"Grupo Aeroportuario de la Ciudad de México, S.A. de C.V."},
                {
                    "name": "Documents",
                    "text":"",
                    "children": [
                        {"name": "Aviso de licitación","text":"Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                        {"name": "Aviso de audiencia pública","text":"Proyecto de Convocatoria a la Licitación Pública Nacional Presencial para los trabajos relativos al drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicado en CompraNet el 3 de junio de 2015"},
                        {"name": "Especificaciones técnicas","text":"Términos de Referencia de la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                        {"name": "Conflictos de interés","text":"Formato de declaración de no conflicto de interés debidamente requisitado y firmado por cada uno de los servidores públicos que participan en el procedimiento de contratación"},
                        {"name": "Inhabilitaciones","text":"Directorio de proveedores y contratistas sancionados de la SFP"},
                        {"name": "Pre-selección de participantes","text":"No aplica para procedimientos realizados bajo la Ley de Obras Públicas y Servicios Relacionados con las Mismas"},
                        {"name": "Criterios evaluación","text":"Secciones 2.13 y 2.14 de la Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                        {"name": "Información de participantes","text":"No aplica"},
                        {"name": "Criterios de elegibilidad","text":"Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"}
                    ]
                },
                {
                    "name": "Hitos",
                    "text":"",
                    "children": [
                        {"name": "Nombre","text":"Visita al sitio de realización de los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México"},
                        {"name":"Descripción","text":"La visita al sitio de realización de los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México dio inicio a las 10:00 horas del 30 de junio de 2015 en el Km. 75 de la Autopista de Cuota Peñon - Texcoco en el Centro Mexicano de Capacitación en Agua y Saneamiento y se dio por concluida a las 12:00 horas del mismo día sin que existiera observación alguna por parte de los asistentes."},
                        {"name":"Fecha","text":"06/30/2015"},
                        {"name":"Estatus","text":"Concluido"},
                        {"name":"Documentos soporte", "text":"Acta de visita al sitio de realización de los trabajos publicada en CompraNet el 1 de julio de 2015"}
                    ]
                },
                {
                    "name": "Modificaciones",
                    "text":"No hubo modificaciones"
                }
            ]
        },
        {
            "name": "Adjudicación",
            "text":"",
            "children": [
                {"name": "ID licitación","text":"838749"},
                {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name": "Título","text":"Acta de emisión de fallo"},
                {"name": "Descripción","text":"Con fundamento en lo dispuesto en el artículo 39, fracción III de la Ley de Obras Públicas y Servicios Relacionados con las Mismas, se adjudica el contrato al consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V., por un importe de $192,522,597.09 (ciento noventa y dos millones quinientos veinticinco mil quinientos noventa y siete Pesos 09/100 M.N.), monto sin considerar el IVA, por resultar ser la propuesta que al ser evaluada técnica y ecómicamente, obtuvo el puntaje más alto acorde al mecanismo de evalación previsto en la convocatoria"},
                {"name": "Estatus","text":"Adjudicado"},
                {"name": "Fecha","text":"09/28/2015"},
                {"name": "Valor","text":"192522597.09"},
                {"name": "Inconformidades recibidas","text":"0"},
                {
                    "name": "Proveedores",
                    "text":"",
                    "children": [
                        {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                        {"name": "ID proveedor","text":"1. Calzada Construcciones, S. A. de C. V.: CCO980814BU4    2. Construcciones y Dragados del Sureste, S. A. de C. V.: CDS970212MV3"},
                        {"name": "Nombre","text":"1. Calzada Construcciones, S. A. de C. V.    2. Construcciones y Dragados del Sureste, S. A. de C. V."},
                        {"name": "Dirección","text":"",
                            "children":[
                                {"name":"Calle","text":"Lope de Vega 117, piso 6"},
                                {"name":"Colonia","text":"Polanco"},
                                {"name":"Municipio","text":"Miguel Hidalgo"},
                                {"name":"Entidad","text":"Ciudad de México"},
                                {"name":"País","text":"México"},
                                {"name":"Código postal","text":"11560"},
                            ]},
                        {"name": "Contacto","text":"No aplica"}
                    ]
                },
                {
                    "name": "Documentos",
                    "text":"",
                    "children": [
                        {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                        {"name": "Reportes de evaluación","text":"Acta de Emisión de Fallo"},
                        {"name": "Propuesta ganadora","text":"Propuesta técnica y económica del Consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V."},
                        {"name": "Inconformidades","text":"No se presentaron inconformidades sobre el procedimiento de contratación"}
                    ]
                },
                {"name":"Item","text":"",
                    "children":[
                        {"name":"ID adjudicación","text":"LO-009KDH999-N50-2015"},
                        {"name":"ID item","text":"62501001"},
                        {"name":"Descripción","text":"Construcción aeropista"},
                        {"name":"Clasificación","text":"Obra pública"},
                        {"name":"Unidad item","text":"Obra"}
                    ]
                },
                {
                    "name": "Modificaciones",
                    "text":"No hubo modificaciones"
                }
            ]
        },
        {
            "name": "Contratación",
            "text":"",
            "children": [
                {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name": "ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
                {"name": "Título","text":"Para los trabajos relativos a la construcción del drenaje pluvial temporal"},
                {"name": "Descripción","text":"Construcción de tres drenes principales, tres canales existentes (parcialmente), tres plantas de bombeo, dos lagunas de regulación, veintidós alcantarilla y dos salidas al Dren General del Valle, al poniente del predio. Rehabilitación de caminos de acceso y puentes alcantarilla para permitir el paso de vehículos de una margen del dren a la margen opuesta."},
                {"name": "Estatus","text":"Activo"},
                {"name": "Periodo","text":"","children":[
                    {"name":"Inicio","text":"10/09/2015"},
                    {"name":"Fin","text":"03/07/2016"}
                ]},
                {"name": "Valor","text":"192525597.09"},
                {"name": "Fecha de firma","text":"10/09/2015"},
                {
                    "name": "Item",
                    "text":"",
                    "children": [
                        {"name":"ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
                        {"name":"ID item","text":"62501001"},
                        {"name":"Descripción","text":"Construcción aeropista"},
                        {"name":"Clasificación","text":"Obra pública"},
                        {"name":"Unidad item","text":"Obra"}
                    ]
                },
                {
                    "name": "Documentos",
                    "text":"",
                    "children": [
                        {"name": "Contrato firmado","text":"Contrato plurianual de obra pública a precios unitarios y tiempo determinado número LPN-OP-DCAGI-SC-076/15"},
                        {"name": "Cláusulas","text":'Cláusula Décimo Quinta del Contrato.- Entrega, Verificación y Finiquito de "La Obra"'},
                        {"name": "Cronograma del contrato","text":"Anexo 17 del contrato: Programa de ejecución de los trabajos"},
                        {"name": "Anexos del contrato","text":'Anexo 1: Suficiencia presupuestaria   Anexo 2: Escrituras públicas de Calzada Construcciones, S.A. de C.V.   Anexo 3: Poder del representante legal de Calzada Construcciones, S.A. de C.V.   Anexo 4: Cédula de Registro Federal de Contribuyentes de Calzada Construcciones, S.A. de C.V.   Anexo 5: Declaración de Calzada Construcciones, S.A. de C.V. de no encontrarse en los supuestos de los artículos 51 y 78 de la Ley de Obras Públicas y Servicios Relacionados con las Mismas   Anexo 6: Opinión del cumplimiento de obligaciones fiscales de Calzada Construcciones, S.A. de C.V.   Anexo 7: Escrituras públicas de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 8: Poder del representante legal de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 9: Cédula del registro federal de contribuyentes de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 10: Declaración de Construcciones y Dragados del Sureste, S.A. de C.V. de no encontrarse en los supuestos de los artículos 51 y 78 de la Ley de Obras Públicas y Servicios Relacionados con las Mismas   Anexo 11: Opinión del cumplimiento de obligaciones fiscales de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 12: Convenio de Participación COnjunta entre Calzada Construcciones, S.A. de C.V. y Construcciones Dragados del Sureste, S.A. de C.V.   Anexo 13: Manifestación de no encontrarse en la estratificación de Micro, Pequeña o Mediana Empresa   Anexo 14: Opinión de cumplimiento de obligaciones fiscales en materia de seguridad social de las contratistas   Anexo 15: Propuesta conjunta de Calzada Construcciones, S.A. de C.V. y Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 16: Términos de Referencia   Anexo 17: Programa de Ejecución de los Trabajos   Anexo 18: Catálogo de Conceptos   Anexo 19: Programa de Pagos   Anexo 20: Datos bancarios de los contratistas   Anexo 21: Programa de amortización del anticipo'},
                        {"name": "Subcontratos","text":"GACM no ha sido notificado sobre ninguna subcontratación"},
                        {"name": "Garantías","text":"","children":[
                            {"name":"Garantías anticipo","text":"Fianza número 0031500012922 emitida el 2015-10-09 por Mapfre Fianzas, S.A. de C.V."},
                            {"name":"Garantías cumplimiento","text":"Fianza números 0031500013560 emitida el 2015-10-09 por Mapfre Fianzas, S.A. de C.V."}
                        ]}
                    ]
                },
                {
                    "name": "Modificaciones",
                    "text":"No se ha celebrado ningún convenio modificatorio."
                }
            ]
        },
        {
            "name": "Implementación",
            "text":"",
            "children": [
                {
                    "name": "Transacción",
                    "text":"",
                    "children": [
                        {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                        {"name": "ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
                        {"name": "ID transacción","text":"1219377"},
                        {"name": "Fuente","text":"Fideicomiso para el desarrollo del Nuevo Aeropuerto Internacional de la Ciudad de México"},
                        {"name": "Fecha","text":"11/27/2015"},
                        {"name": "Monto","text":"15,786,533.19"},
                        {"name": "Emisor","text":"Nacional Financiera, Sociedad Nacional de Crédito, Institución de Banca de Desarrollo, como fiduciaria del Fideicomiso para el desarrollo del NAICM"},
                        {"name": "Receptor","text":"Consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V."}
                    ]
                },
                {
                    "name": "Documentos",
                    "text":"",
                    "children": [
                        {"name": "Avance físico","text":"18.34%"},
                        {"name": "Avance financiero","text":"10%"},
                        {"name": "Certificado de terminación","text":"El contrato continúa en ejecución"},
                        {"name": "Auditoría final","text":"No aplica"}
                    ]
                },
                {
                    "name": "Hitos",
                    "text":"No se han recibido estimaciones por parte del contratista."
                }

            ]
        }
    ]
};

var json_plan =
{
    "name": "Planeación",
    "text":"",
    "children": [
        {
            "name": "Presupuesto",
            "text":"",
            "children": [
                {"name": "Fuente","text":"Presupuesto de Egresos de la Fedración 2015 y 2016"},
                {"name": "ID","text":"1409JZL0005"},
                {"name": "Descripción","text":"Transferencias a fideicomisos públicos"},
                {"name": "Total","text":"$490,000,000.00"},
                {"name": "Proyecto presupuestario","text":"Nuevo Aeropuerto Internacional de la Ciudad de México"}
            ]
        },
        {"name":"Fundamento",
            "text":'Dado que las precipitaciones locales escurrierón hacia las zonas más bajas del polígono, lo que antiguamente fuera el lago de Texcoco, durante la construcción del NAICM se requeririó; un drenaje pluvial provisional de funcionamiento temporal dentro del perímetro de la construcción, que permita asegurar la protección de dichas obras. Lo anterior, con el objetivo de asegurar que las zonas donde se esté desarrollando los trabajos permanezcan secas.'},
        {
            "name": "Documentos",
            "text":"",
            "children": [
                {"name": "Estudio factibilidad", "text":"Factibilidad técnica, legal y ambiental del proyecto de desarrollo del Nuevo Aeropuerto Internacional de la Ciudad de México"},
                {"name": "Evaluación necesidades", "text":"Términos de referencia para la construcción del drenaje pluvial temporal para la protección de la zona durante la construcción de la primera fase del NAICM publicados en CompraNet el 24 de junio de 2015"},
                {"name": "Estudio mercado", "text":"No aplica"}
            ]
        }
    ]
};

var json_lic =
{
    "name": "Licitación",
    "text":"",
    "children": [
        {"name": "ID","text":"838749"},
        {"name": "Titulo","text":"Para los trabajos relativos a la construcción del drenaje pluvial temporal"},
        {"name": "Descripción","text":"Licitación Pública Nacional que tuvo por objeto la adjudicación del contrato para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México."},
        {"name": "Estatus","text":"Adjudicado"},
        {"name": "Valor mínimo","text":"No aplica"},
        {"name": "Valor","text":"490,000,000.00"},
        {"name": "Método de adquisición","text":"Licitación Pública",
            "children":[
                {"name": "Carácter","text":"Nacional"},
                {"name": "Forma del proceso","text":"Presencial"},
                {"name":"Fundamento","text":"Artículo 27, segundo párrafo de la Ley de Obras Públicas y Servicios Relacionados con las Mismas"}
            ]},
        {"name": "Item","text":"",
            "children":[
                {"name":"Clasificación","text":"62501001"},
                {"name":"Cantidad","text":"1"},
                {"name":"Unidad","text":"Obra"}
            ]},
        {"name": "Criterio Adjudicación","text":"Puntos y Porcentajes",
            "children":[{"name":"Detalles","text":"1. EVALUACIÓN DE LA PROPUESTA TÉCNICA: I. CALIDAD DE LA OBRA.- (a) Que los materiales propuestos para la ejecución de los trabajos cumplan con los estándares de calidad y medidas ambientales. (3.0); (b) Mano de Obra. Que la mano de obra propuesta para la ejecución de los trabajos, cumpla con los requisitos administrativos y con las aptitudes establecidos (3.0); (c) Maquinaria y equipo. Que la maquinaria y vehículos propuestos para la ejecución de los trabajos cumplan con los estándares de calidad y medidas ambientales exigidas (5.0); (d) Esquema estructural de la organización de los profesionales técnicos que se encargarán de la dirección y coordinación de los trabajos. Que el esquema estructural de profesionales técnicos (organigrama) propuesto, es el adecuado, suficiente y necesario (0.5); (e) Procedimiento constructivo. Que las técnicas propuestas a utilizar para la ejecución de los trabajos, sean congruentes con las características, complejidad y magnitud de trabajos a ejecutar en el proyecto (5.0); (f) Programas. Que exista una congruencia entre los programas generales y específicos de la obra (1.5), y (g) Descripción de la planeación integral para la ejecución de los trabajos. Explicación detallada de los procesos que se utilizaran en la ejecución, desarrollo y organización de los trabajos (2.0). II. CAPACIDAD LICITANTE.- (a) Capacidad de los recursos humanos. Que el personal profesional técnico ha participado en por lo menos 5 proyectos similares al que se licita (5.0); (b) Capacidad de los recursos económicos. Serán los recursos económicos que se consideren necesarios para que el licitante cumpla con el contrato (4.0); (c) Participación de discapacitados o empresas que cuenten con trabajadores con discapacidad (0.5), y (d) Subcontratación de MIPYMES. Se otorgará al licitante el puntaje indicado; se verificará que la proposición que contenga la documentación con la cual demuestre que subcontratará MIPYMES (0.5). III. EXPERIENCIA Y ESPECIALIDAD.- (a) Experiencia. Se verificará que el licitante durante los últimos 10 años ha ejecutado obras similares a los que se licitan (7.0), y (b) Especialidad. Se verificará que dentro de los últimos 10 años, el licitante ha ejecutado por lo menos 5 obras con las características, complejidad y magnitud específicas y a los volúmenes y condiciones similares a las requeridas por la convocante (8.0). IV. CUMPLIMIENTO DE CONTRATOS.- (a) Cumplimiento de contratos. Se verificará que por lo menos 5 obras ejecutadas por el licitante en los últimos 10 años, se hayan terminado en tiempo y forma (5.0).   2. EVALUACIÓN DE LA PROPUESTA EÉ El total de pÉde la proposición económica, tendrá un valor numérico máximo de 50. Para llevar a cabo la evaluación de la propuesta económica, la convocante verificará que el análisis, cálculo e integración de los precios cumplan con la condición de pago establecida en la convocatoria o Licitación en términos del artículo 45 de la Ley y los artículos 45 y del 185 al 220"}]},
        {"name": "Método de recepción","text":"Presencial",
            "children":[{"name":"Detalles","text":"El acto de presentación y apertura de proposiciones se llevó a cabo a las 12:00 horas del 6 de agosto de 2015, en la sala de juntas ubicada en Av. Insurgentes Sur 2453, piso 2, Torre Murano, Colonia Tizapan San Angel, Delegación Alvaro Obregón, México, D.F., C.P. 01090. El acto fue presidido por el Subdirector de Contrataciones de GACM.    Los documentos técnicos T.2 y T.3, así como la documentación económica E-10, correspondiente a las 32 proposiciones presentadas, fueron rubricados por los representantes de tres licitantes y un consorcio."}]
        },
        {"name": "Periodo recepción de propuestas","text":"08/06/2015"},
        {"name": "Periodo aclaraciones","text":"",
            "children":[{"name":"inicio","text":"07/03/2015"},
                {"name":"fin","text":"07/22/2015"}]},
        {"name": "Criterio de elegibilidad","text":"Numeral 2.10 de la Convocatoria"},
        {"name": "Periodo adjudicación","text":"07/21/2015"},
        {"name": "Tuvo aclaraciones","text":"371"},
        {"name": "Tuvo testigo social","text":"1"},
        {"name": "Testigo social","text":"",
            "children":[{"name":"ID","text":"IMA941216HE8"},
                {"name":"Nombre","text":"Instituto Mexicano de Auditoría Técnica, A. C."}]},
        {"name": "Número de participantes","text":"32"},
        {"name": "Entidad que contrata", "text":"Grupo Aeroportuario de la Ciudad de México, S.A. de C.V."},
        {
            "name": "Documents",
            "text":"",
            "children": [
                {"name": "Aviso de licitación","text":"Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                {"name": "Aviso de audiencia pública","text":"Proyecto de Convocatoria a la Licitación Pública Nacional Presencial para los trabajos relativos al drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicado en CompraNet el 3 de junio de 2015"},
                {"name": "Especificaciones técnicas","text":"Términos de Referencia de la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                {"name": "Conflictos de interés","text":"Formato de declaración de no conflicto de interés debidamente requisitado y firmado por cada uno de los servidores públicos que participan en el procedimiento de contratación"},
                {"name": "Inhabilitaciones","text":"Directorio de proveedores y contratistas sancionados de la SFP"},
                {"name": "Pre-selección de participantes","text":"No aplica para procedimientos realizados bajo la Ley de Obras Públicas y Servicios Relacionados con las Mismas"},
                {"name": "Criterios evaluación","text":"Secciones 2.13 y 2.14 de la Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"},
                {"name": "Información de participantes","text":"No aplica"},
                {"name": "Criterios de elegibilidad","text":"Convocatoria a la Licitación Pública Nacional Presencial LO-009KDH999-N50-2015 para los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto Internacional de la Ciudad de México publicada en CompraNet el 24 de junio de 2015"}
            ]
        },
        {
            "name": "Hitos",
            "text":"",
            "children": [
                {"name": "Nombre","text":"Visita al sitio de realización de los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México"},
                {"name":"Descripción","text":"La visita al sitio de realización de los trabajos relativos a la construcción del drenaje pluvial temporal del Nuevo Aeropuerto de la Ciudad de México dio inicio a las 10:00 horas del 30 de junio de 2015 en el Km. 75 de la Autopista de Cuota Peñon - Texcoco en el Centro Mexicano de Capacitación en Agua y Saneamiento y se dio por concluida a las 12:00 horas del mismo día sin que existiera observación alguna por parte de los asistentes."},
                {"name":"Fecha","text":"06/30/2015"},
                {"name":"Estatus","text":"Concluido"},
                {"name":"Documentos soporte", "text":"Acta de visita al sitio de realización de los trabajos publicada en CompraNet el 1 de julio de 2015"}
            ]
        },
        {
            "name": "Modificaciones",
            "text":"No hubo modificaciones"
        }
    ]
};
var json_adj =
{
    "name": "Adjudicación",
    "text":"",
    "children": [
        {"name": "ID licitación","text":"838749"},
        {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
        {"name": "Título","text":"Acta de emisión de fallo"},
        {"name": "Descripción","text":"Con fundamento en lo dispuesto en el artículo 39, fracción III de la Ley de Obras Públicas y Servicios Relacionados con las Mismas, se adjudica el contrato al consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V., por un importe de $192,522,597.09 (ciento noventa y dos millones quinientos veinticinco mil quinientos noventa y siete Pesos 09/100 M.N.), monto sin considerar el IVA, por resultar ser la propuesta que al ser evaluada técnica y ecómicamente, obtuvo el puntaje más alto acorde al mecanismo de evalación previsto en la convocatoria"},
        {"name": "Estatus","text":"Adjudicado"},
        {"name": "Fecha","text":"09/28/2015"},
        {"name": "Valor","text":"192522597.09"},
        {"name": "Inconformidades recibidas","text":"0"},
        {
            "name": "Proveedores",
            "text":"",
            "children": [
                {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name": "ID proveedor","text":"1. Calzada Construcciones, S. A. de C. V.: CCO980814BU4    2. Construcciones y Dragados del Sureste, S. A. de C. V.: CDS970212MV3"},
                {"name": "Nombre","text":"1. Calzada Construcciones, S. A. de C. V.    2. Construcciones y Dragados del Sureste, S. A. de C. V."},
                {"name": "Dirección","text":"",
                    "children":[
                        {"name":"Calle","text":"Lope de Vega 117, piso 6"},
                        {"name":"Colonia","text":"Polanco"},
                        {"name":"Municipio","text":"Miguel Hidalgo"},
                        {"name":"Entidad","text":"Ciudad de México"},
                        {"name":"País","text":"México"},
                        {"name":"Código postal","text":"11560"},
                    ]},
                {"name": "Contacto","text":"No aplica"}
            ]
        },
        {
            "name": "Documentos",
            "text":"",
            "children": [
                {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name": "Reportes de evaluación","text":"Acta de Emisión de Fallo"},
                {"name": "Propuesta ganadora","text":"Propuesta técnica y económica del Consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V."},
                {"name": "Inconformidades","text":"No se presentaron inconformidades sobre el procedimiento de contratación"}
            ]
        },
        {"name":"Item","text":"",
            "children":[
                {"name":"ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name":"ID item","text":"62501001"},
                {"name":"Descripción","text":"Construcción aeropista"},
                {"name":"Clasificación","text":"Obra pública"},
                {"name":"Unidad item","text":"Obra"}
            ]
        },
        {
            "name": "Modificaciones",
            "text":"No hubo modificaciones"
        }
    ]
};

var json_cont =
{
    "name": "Contratación",
    "text":"",
    "children": [
        {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
        {"name": "ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
        {"name": "Título","text":"Para los trabajos relativos a la construcción del drenaje pluvial temporal"},
        {"name": "Descripción","text":"Construcción de tres drenes principales, tres canales existentes (parcialmente), tres plantas de bombeo, dos lagunas de regulación, veintidós alcantarilla y dos salidas al Dren General del Valle, al poniente del predio. Rehabilitación de caminos de acceso y puentes alcantarilla para permitir el paso de vehículos de una margen del dren a la margen opuesta."},
        {"name": "Estatus","text":"Activo"},
        {"name": "Periodo","text":"","children":[
            {"name":"Inicio","text":"10/09/2015"},
            {"name":"Fin","text":"03/07/2016"}
        ]},
        {"name": "Valor","text":"192525597.09"},
        {"name": "Fecha de firma","text":"10/09/2015"},
        {
            "name": "Item",
            "text":"",
            "children": [
                {"name":"ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
                {"name":"ID item","text":"62501001"},
                {"name":"Descripción","text":"Construcción aeropista"},
                {"name":"Clasificación","text":"Obra pública"},
                {"name":"Unidad item","text":"Obra"}
            ]
        },
        {
            "name": "Documentos",
            "text":"",
            "children": [
                {"name": "Contrato firmado","text":"Contrato plurianual de obra pública a precios unitarios y tiempo determinado número LPN-OP-DCAGI-SC-076/15"},
                {"name": "Cláusulas","text":'Cláusula Décimo Quinta del Contrato.- Entrega, Verificación y Finiquito de "La Obra"'},
                {"name": "Cronograma del contrato","text":"Anexo 17 del contrato: Programa de ejecución de los trabajos"},
                {"name": "Anexos del contrato","text":'Anexo 1: Suficiencia presupuestaria   Anexo 2: Escrituras públicas de Calzada Construcciones, S.A. de C.V.   Anexo 3: Poder del representante legal de Calzada Construcciones, S.A. de C.V.   Anexo 4: Cédula de Registro Federal de Contribuyentes de Calzada Construcciones, S.A. de C.V.   Anexo 5: Declaración de Calzada Construcciones, S.A. de C.V. de no encontrarse en los supuestos de los artículos 51 y 78 de la Ley de Obras Públicas y Servicios Relacionados con las Mismas   Anexo 6: Opinión del cumplimiento de obligaciones fiscales de Calzada Construcciones, S.A. de C.V.   Anexo 7: Escrituras públicas de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 8: Poder del representante legal de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 9: Cédula del registro federal de contribuyentes de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 10: Declaración de Construcciones y Dragados del Sureste, S.A. de C.V. de no encontrarse en los supuestos de los artículos 51 y 78 de la Ley de Obras Públicas y Servicios Relacionados con las Mismas   Anexo 11: Opinión del cumplimiento de obligaciones fiscales de Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 12: Convenio de Participación COnjunta entre Calzada Construcciones, S.A. de C.V. y Construcciones Dragados del Sureste, S.A. de C.V.   Anexo 13: Manifestación de no encontrarse en la estratificación de Micro, Pequeña o Mediana Empresa   Anexo 14: Opinión de cumplimiento de obligaciones fiscales en materia de seguridad social de las contratistas   Anexo 15: Propuesta conjunta de Calzada Construcciones, S.A. de C.V. y Construcciones y Dragados del Sureste, S.A. de C.V.   Anexo 16: Términos de Referencia   Anexo 17: Programa de Ejecución de los Trabajos   Anexo 18: Catálogo de Conceptos   Anexo 19: Programa de Pagos   Anexo 20: Datos bancarios de los contratistas   Anexo 21: Programa de amortización del anticipo'},
                {"name": "Subcontratos","text":"GACM no ha sido notificado sobre ninguna subcontratación"},
                {"name": "Garantías","text":"","children":[
                    {"name":"Garantías anticipo","text":"Fianza número 0031500012922 emitida el 2015-10-09 por Mapfre Fianzas, S.A. de C.V."},
                    {"name":"Garantías cumplimiento","text":"Fianza números 0031500013560 emitida el 2015-10-09 por Mapfre Fianzas, S.A. de C.V."}
                ]}
            ]
        },
        {
            "name": "Modificaciones",
            "text":"No se ha celebrado ningún convenio modificatorio."
        }
    ]
};

var json_imp =      {
    "name": "Implementación",
    "text":"",
    "children": [
        {
            "name": "Transacción",
            "text":"",
            "children": [
                {"name": "ID adjudicación","text":"LO-009KDH999-N50-2015"},
                {"name": "ID contrato","text":"LPN-OP-DCAGI-SC-076/15"},
                {"name": "ID transacción","text":"1219377"},
                {"name": "Fuente","text":"Fideicomiso para el desarrollo del Nuevo Aeropuerto Internacional de la Ciudad de México"},
                {"name": "Fecha","text":"11/27/2015"},
                {"name": "Monto","text":"15,786,533.19"},
                {"name": "Emisor","text":"Nacional Financiera, Sociedad Nacional de Crédito, Institución de Banca de Desarrollo, como fiduciaria del Fideicomiso para el desarrollo del NAICM"},
                {"name": "Receptor","text":"Consorcio integrado por las empresas Calzada Construcciones, S. A. de C. V. y Construcciones y Dragados del Sureste, S. A. de C. V."}
            ]
        },
        {
            "name": "Documentos",
            "text":"",
            "children": [
                {"name": "Avance físico","text":"18.34%"},
                {"name": "Avance financiero","text":"10%"},
                {"name": "Certificado de terminación","text":"El contrato continúa en ejecución"},
                {"name": "Auditoría final","text":"No aplica"}
            ]
        },
        {
            "name": "Hitos",
            "text":"No se han recibido estimaciones por parte del contratista."
        }

    ]
};

//var width    = 1200;
//var height   = 450;
var maxLabel = 150;
var duration = 500;
var radius   = 3;

// Set the dimensions of the canvas / graph
var margin = {
    top: 30,
    right: 20,
    bottom: 30,
    left: 50
},
    width = 1024 - margin.left - margin.right,
    height = 670 - margin.top - margin.bottom;

var i = 0;
var root;

//---------------------------

var tree = d3.layout.tree()
    .size([height, width]);

var diagonal = d3.svg.diagonal()
    .projection(function(d) { return [d.y, d.x]; });

var svg = d3.select("#arbol").append("svg")
    .attr("width", width)
    .attr("height", height)
    .append("g")
    .attr("transform", "translate(" + maxLabel + ",0)");

root    = json;
root.x0 = height / 2;
root.y0 = 0;

/* original code */
/*
update(root);

d3.select(self.frameElement).style("height", "500px");

function update(source) {

    // Compute the new tree layout.
    var nodes = tree.nodes(root).reverse(),
        links = tree.links(nodes);

    // Normalize for fixed-depth.
    nodes.forEach(function(d) { d.y = d.depth * 180; });

    // Update the nodes…
    var node = svg.selectAll("g.node")
        .data(nodes, function(d) { return d.id || (d.id = ++i); });

    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter().append("g")
        .attr("class", "node")
        .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
        .on("click", click);

    nodeEnter.append("circle")
        .attr("r", 1e-6)
        .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

    nodeEnter.append("text")
        .attr("x", function(d) { return d.children || d._children ? -13 : 13; })
        .attr("dy", ".35em")
        .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
        .text(function(d) { return d.name; })
        .style("fill-opacity", 1e-6);

    // Transition nodes to their new position.
    var nodeUpdate = node.transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

    nodeUpdate.select("circle")
        .attr("r", 10)
        .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

    nodeUpdate.select("text")
        .style("fill-opacity", 1);

    // Transition exiting nodes to the parent's new position.
    var nodeExit = node.exit().transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
        .remove();

    nodeExit.select("circle")
        .attr("r", 1e-6);

    nodeExit.select("text")
        .style("fill-opacity", 1e-6);

    // Update the links…
    var link = svg.selectAll("path.link")
        .data(links, function(d) { return d.target.id; });

    // Enter any new links at the parent's previous position.
    link.enter().insert("path", "g")
        .attr("class", "link")
        .attr("d", function(d) {
            var o = {x: source.x0, y: source.y0};
            return diagonal({source: o, target: o});
        });

    // Transition links to their new position.
    link.transition()
        .duration(duration)
        .attr("d", diagonal);

    // Transition exiting nodes to the parent's new position.
    link.exit().transition()
        .duration(duration)
        .attr("d", function(d) {
            var o = {x: source.x, y: source.y};
            return diagonal({source: o, target: o});
        })
        .remove();

    // Stash the old positions for transition.
    nodes.forEach(function(d) {
        d.x0 = d.x;
        d.y0 = d.y;
    });
}

// Toggle children on click.
function click(d) {
    if (d.children) {
        d._children = d.children;
        d.children = null;
    } else {
        d.children = d._children;
        d._children = null;
    }
    update(d);
}
*/



root.children.forEach(collapse);

// Define the div for the tooltip
var div = d3.select("#arbol").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);


//------------Circle bar----
var barCircles  = [
    {"x_axis":150, "y_axis":18, "radius":10, "color": "#424242",   "name":"Planeación"},
    {"x_axis":310, "y_axis":18, "radius":10, "color": "#424242",  "name":"Licitación"},
    {"x_axis":470, "y_axis":18, "radius":10, "color": "#424242",  "name":"Adjudicación"},
    {"x_axis":630, "y_axis":18, "radius":10, "color": "#424242",  "name":"Contratación"},
    {"x_axis":790, "y_axis":18, "radius":10, "color": "#424242", "name":"Implementación"}
];

var svgContainer = d3.select("#bolitas").append("svg")
    .attr("width",  800)
    .attr("height", 50);

var line = svgContainer.append("line")
    .attr("x1", 160)
    .attr("y1", 18)
    .attr("x2", 800)
    .attr("y2", 18)
    .attr("stroke-width", 15)
    .attr("stroke", "#9e9e9e")
    .style("opacity",.3);


var circles = svgContainer.selectAll("circle")
    .data(barCircles)
    .enter()
    .append("circle");

var circleAttributes = circles
    .attr("cx", function (d) { return d.x_axis; })
    .attr("cy", function (d) { return d.y_axis; })
    .attr("r", function (d) { return d.radius; })
    .style("opacity", function(d) { return .8; })
    .style("fill", function(d) { return d.color; })
    .on("click", function(d){
        svgContainer.selectAll("circle").style("fill", "#424242");
        var s_circle = d3.select(this);
        s_circle.style("fill", "#00cc99");

        var data;

        var add_data = d3.select("#add_data")
            .style("display","block")
            .selectAll("#etapa")
            .data([d.name])
            .transition()
            .duration(1000)
            .text(function(d){return d;})
            .style("font-weight","bold");

        if ( d.name == 'Planeación'){
            root = json_plan;
            update(root);
            data = json_plan.children;
        }else if( d.name == 'Licitación'){
            root = json_lic;
            update(root);
            data = json_lic.children;
        }else if( d.name == 'Adjudicación' ){
            data = json_adj.children;
            root = json_adj;
            update(root);
        }else if( d.name == 'Contrato'){
            root = json_cont;
            update(root);
            data = json_cont.children;
        }else if( d.name == 'Implementación'){
            root = json_imp;
            update(root);
            data = json_imp.children;
        } else {
            data = json_plan.children;
        }

        // Clean data
        d3.select("#etapa_desglo")
            .selectAll("div")
            .remove();

        // Fill in data.
        for(var i = 0; i < data.length; i++){ // var i?
            d3.select("#etapa_desglo")
                .selectAll("p" + i)
                .data(["" + data[i].name + ""])
                .enter()
                .append("div")
                .attr("id","child" + i)
                .text(function(d){ return d;})
                .style("font-weight", "bold")
                .style("color","#424242");

            d3.select("#child" + i)
                .selectAll("p")
                .data([data[i]])
                .enter()
                .append("div")
                .attr("id", "#child-child" + i)
                .append("p")
                .text(function(d){ if(d.hasOwnProperty('children') == false){ return d.text;}else{
                    return d.children[0].text;
                }})
                .append("hr")
                .style("border-color","#BDBDBD");

        }




    })
    .on("mouseover", function(d){
        d3.select(this).transition()
            .duration(200).attr("r", function(d){return 12;});
        var add_data = d3.select("#add_data")
            .selectAll("#etapa")
            .data([name])
            .enter()
            .append("p");
    })
    .on("mouseout", function(d){
        d3.select(this).transition()
            .duration(200).attr("r", function(d){return 10;});
    });


// Div con Información adicional sobre los contratos


window.onload = function(){
    root = json;
    update(root);
};

function update(source){
    // Compute the new tree layout.
    var nodes = tree.nodes(root).reverse();
    var links = tree.links(nodes);

    // Normalize for fixed-depth.
    nodes.forEach(function(d) { d.y = d.depth * maxLabel*1.4; });

    // Update the nodes…
    var node = svg.selectAll("g.node")
        .data(nodes, function(d){
            return d.id || (d.id = ++i);
        });

    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter()
        .append("g")
        .attr("class", "node")
        .attr("transform", function(d){ return "translate(" + source.y0 + "," + source.x0 + ")"; })
        .on("click",function(d){
            if (d.children){
                d._children = d.children;
                d.children = null;
            }
            else{
                d.children = d._children;
                d._children = null;
            }
            update(d);
        })

        .on("mouseover", function(d) {
            div.transition()
                .duration(200)
                .style("opacity", d.text.length>0?.9:0);
            div.html(d.text)
                .style("left", (d3.event.pageX) + "px")
                .style("top",  (d3.event.pageY - 10) + "px")
                .style("width",   //d.text.length*10  + "px"
                        300 + "px")
                .style("height",  //d.text.length*10  + "px"
                "auto");
        })
        .on("mouseout", function(d) {
            div.transition()
                .duration(500)
                .style("opacity", 0);
        });

    nodeEnter.append("circle")
        .attr("r", 0)
        .style("fill", function(d){
            return d._children ? "white" : "#00cc99";
        })
        .style("stroke", function(d){
            return d._children ? "#9E9E9E" : "#00cc99";
        });

    nodeEnter.append("text")
        .attr("x", function(d){
            var spacing = computeRadius(d) + 5;
            return d.children || d._children ? -spacing : spacing;
        })
        .attr("dy", "3")
        .attr("text-anchor", function(d){ return d.children || d._children ? "end" : "start"; })
        .text(function(d){ return d.name; })
        .style("fill-opacity", 0);



    // Transition nodes to their new position.
    var nodeUpdate = node.transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

    nodeUpdate.select("circle")
        .attr("r", function(d){ return computeRadius(d); })
        .style("fill", function(d) { return d._children ? "white" : "#00cc99"; })
        .style("stroke", function(d){
            return d._children ? "#9E9E9E" : "#00cc99";
        });

    nodeUpdate.select("text").style("fill-opacity", 1)
        .style("color", "#424242");

    // Transition exiting nodes to the parent's new position.
    var nodeExit = node.exit().transition()
        .duration(duration)
        .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
        .remove();

    nodeExit.select("circle").attr("r", 0);
    nodeExit.select("text").style("fill-opacity", 0);

    // Update the links…
    var link = svg.selectAll("path.link")
        .data(links, function(d){ return d.target.id; });

    // Enter any new links at the parent's previous position.
    link.enter().insert("path", "g")
        .attr("class", "link")
        .attr("d", function(d){
            var o = {x: source.x0, y: source.y0};
            return diagonal({source: o, target: o});
        })
        .on("mouseover", function(d){
            d3.select(this).style("stroke", "#00cc99");
            d3.select(this).style("stroke-width", "9px");
        })
        .on("mouseout", function(d){
            d3.select(this).style("stroke", "#9E9E9E");
            d3.select(this).style("stroke-width", "5.5px");
        });

    // Transition links to their new position.
    link.transition()
        .duration(duration)
        .attr("d", diagonal);


    // Transition exiting nodes to the parent's new position.
    link.exit().transition()
        .duration(duration)
        .attr("d", function(d){
            var o = {x: source.x, y: source.y};
            return diagonal({source: o, target: o});
        })
        .remove();

    // Stash the old positions for transition.
    nodes.forEach(function(d){
        d.x0 = d.x;
        d.y0 = d.y;
    });
}

function computeRadius(d){
    if(d.children || d._children) return radius + (radius * nbEndNodes(d) / 10);
    else return radius;
}

function nbEndNodes(n){
    nb = 0;
    if(n.children){
        n.children.forEach(function(c){
            nb += nbEndNodes(c);
        });
    }
    else if(n._children){
        n._children.forEach(function(c){
            nb += nbEndNodes(c);
        });
    }
    else nb++;

    return nb;
}

function click(d){
    if (d.children){
        d._children = d.children;
        d.children = null;
    }
    else{
        d.children = d._children;
        d._children = null;
    }
    update(d);
}

function collapse(d){
    if (d.children){
        d._children = d.children;
        d._children.forEach(collapse);
        d.children = null;
    }
}

$('#refresh').on("click", function(event){
    var add_data = d3.select("#add_data")
        .transition()
        .duration(200)
        .style("display","none");
    root = json;
    svgContainer.selectAll("circle").style("fill", "#424242");
    update(root);
    update ( json );
});
